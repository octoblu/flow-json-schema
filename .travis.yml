language: node_js
node_js:
- '0.11'
- '0.10'
install:
- sudo pip install awscli  #install AWS cli
before_deploy:
- ./node_modules/gulp/bin/gulp.js build
- mkdir -p deploy/latest
- mkdir -p deploy/$TRAVIS_TAG
- cp dist/schema-registry.json deploy/latest
- cp dist/schema-registry.json deploy/$TRAVIS_TAG
env:
  global:
    secure: oQF0NGUljvB1/SDEyl7682DHwT5k2Tr25WentG6TjRwolledSmO3U4pxZ8RWlVmP1GsZIi5DCq/fyXfMl0UX+xXVsZqKKjRHEuJKBAlkRWS35ciawbafOI7rtK0MUb6/l8zyALyi/80MDey90xIZ8wQfORb2RoD9OnaoFtW2xlZP44hmlmakxYUf013F+NYMmLaG3m/9uxAU650sH1dYig8bEOLTsR8v3Ougj7rKr25MXSjOtZZ211feSUrZtfeRvpTeltA204dTwzk7waLwXflzWTnvA6VHYXHFIp/UhfOKKBo6ODrsAs2m/HQZUd+b63nW/Ep5IsyckdxlGU+IzvUcrkasvJL4Y80vF4nLA7UDf31cr7LKjYdpRddhbmGOcnNg4ubvRHL9dqOe4alhuR0J5f1F03dKvvnxB8vpwd7ps8JIg9rcGFtjt0/ExBb3CVsCg0dNkelOGPQGSE/vMqW0mItl+xZo6vjrcAlRoQdYUBbatWsBfqnOdiIxbIArzgnOhsA3g4tGvunMpKU5A5CTgHlqaKrttAyuy0LWpAIPhds09wXyKaCq3V2FGg6TmYv9E/MkZ1VBWRU8MFOY94KCzqPEOpop/Nh8v7+CDP/9R6VVvfNRH6AqVwL4gSex477hW5ywOKLeIdItipYuOE+wo+cZJMAAOzxvmwQpw1o=
after_success:
  - if [[ "$TRAVIS_BRANCH" != "master" ]]; then echo "Deployments are only done for the master branch. Current branch is $TRAVIS_BRANCH"; exit 0; fi
  - echo "Deploying build $TRAVIS_BUILD_NUMBER"
  - aws s3 cp deploy/ s3://tool-schema-registry --recursive
deploy:
  provider: s3
  access_key_id: AKIAJTQHLCZHU6QOGSWA
  secret_access_key:
    secure: oQF0NGUljvB1/SDEyl7682DHwT5k2Tr25WentG6TjRwolledSmO3U4pxZ8RWlVmP1GsZIi5DCq/fyXfMl0UX+xXVsZqKKjRHEuJKBAlkRWS35ciawbafOI7rtK0MUb6/l8zyALyi/80MDey90xIZ8wQfORb2RoD9OnaoFtW2xlZP44hmlmakxYUf013F+NYMmLaG3m/9uxAU650sH1dYig8bEOLTsR8v3Ougj7rKr25MXSjOtZZ211feSUrZtfeRvpTeltA204dTwzk7waLwXflzWTnvA6VHYXHFIp/UhfOKKBo6ODrsAs2m/HQZUd+b63nW/Ep5IsyckdxlGU+IzvUcrkasvJL4Y80vF4nLA7UDf31cr7LKjYdpRddhbmGOcnNg4ubvRHL9dqOe4alhuR0J5f1F03dKvvnxB8vpwd7ps8JIg9rcGFtjt0/ExBb3CVsCg0dNkelOGPQGSE/vMqW0mItl+xZo6vjrcAlRoQdYUBbatWsBfqnOdiIxbIArzgnOhsA3g4tGvunMpKU5A5CTgHlqaKrttAyuy0LWpAIPhds09wXyKaCq3V2FGg6TmYv9E/MkZ1VBWRU8MFOY94KCzqPEOpop/Nh8v7+CDP/9R6VVvfNRH6AqVwL4gSex477hW5ywOKLeIdItipYuOE+wo+cZJMAAOzxvmwQpw1o=
  bucket: tool-schema-registry
  region: us-west-2
  local-dir: deploy
  acl: ''
  on:
    tags: true
    all_branches: true
  api_key:
    secure: mx8sUe+b7194nlUdrQb+USg6GQVQSt9jo/a4hPTMGsziAxQ4pit5Y19Kw/AsAV0d+1dcWDx4bKiGOlgqk1Jx7epvvpDdbKsSlRNXOHSchOspi33wTMx7dMR/tzPeztuc79KBOkzxpwcmNv5sUOS3TJ4Ps3viCj4GQ0iykPGo5mMr/WNqv8vHmutlfhxB8p38usWr3Ndu4vMGCi9KaUlKJOR61VCi+r1/vSEwclPQy6RaDWVuIaPBURNwqWx4W/EVrkrJTypMo8jxZNAfWfNsCQHos28AvBgZLkNGF2r44Weafvjrc+kSeq7fWRCH9TrsoNgWPdZWdP/6WzpMyyDDvguZvVStTFPfbO6/4dTvuPipOvqLptuT2FO5+nsdD15VxgyHvDp9jfvkTIua4W+qqkc7mXEfX/eFeumi9O3WxVkxEYB3zauOrTcLMXmr5dc4FrRwZQ5MuFC/tACyzX1VNLhmdC3xstKCWjq7QufiJDp4w2tLpsJR5ezXAt10zMZgdebDHtnN5Qaq1Edgb/gWXeRkzQM0Wc3bTLQAoDkyi7+LJiG6Y+A9iBVEur96N5BKqQeQ1UuxGYdWPi6mn8Ovb6nOPhpLE+7ghaTScLYHPSaSZ09Gs2hchZJhn4Ba9BCg2TH6YAbDvV/Kh+Ex3xaJBO4xnvIXdx3Qj6DX3VN4kPg=
